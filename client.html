<!DOCTYPE html>
<html>
	<head>
		<script src="/socket.io/socket.io.js"></script>
		<script type="text/javascript">
			var mysocket = "127.0.0.1:1337"
			if (process.env.PROD=="True") {
				mysocket = "https://nlp-chat.herokuapp.com/"
			}
			var socketio = io.connect(mysocket);

			socketio.on("message_to_client", function(data) {
				document.getElementById("chatlog").innerHTML = ("<hr/> " + "<span class='message_text'>" + data['message'] + "</span>" + "<span class='sender_indicator''>You</span>" + document.getElementById("chatlog").innerHTML);
			});

			socketio.on("message_from_nlp", function(data) {
				document.getElementById("chatlog").innerHTML = ("<hr/> " + "<span class='message_text'>" + data['message'] + "</span>" + "<span class='sender_indicator'>You</span>" + document.getElementById("chatlog").innerHTML);
			});

			function sendMessage() {
				var msg = document.getElementById("message_input").value;
				socketio.emit("message_to_server", { message : msg });
				document.getElementById("message_input").value = "";
			}
		</script>
	</head>
	<body>
		<input type="text" id="message_input"/>
		<button onclick="sendMessage()" id="send_button">send</button>
		<div id="chatlog"></div>
		<script type="text/javascript">
			document.getElementById("message_input")
			    .addEventListener("keyup", function(event) {
			    event.preventDefault();
			    if (event.keyCode == 13) {
			        document.getElementById("send_button").click();
			    }
			});
		</script>
		<style>
			.sender_indicator {
				text-align: right;
				position: absolute;
				right: 10px;
			}
			.message_text {
				font-size: 1.5em;
			}
		</style>
	</body>
</html>